---
title: "Linear Regression Via Category Theory"
author: "Bradley Saul"
date: 2022-06-20T14:19:14-05:00
tags: ["Haskell", "R", "statistics", "linear model", "category theory"]
---



<p>A couple of years ago,
I read
<a href="http://conal.net/">Conal Elliot’s</a>
<a href="http://conal.net/papers/compiling-to-categories/">Compiling to Categories</a> paper.
I thought at the time “Wow, this is amazing”,
but I didn’t have the key that made the ideas concrete for me.
<a href="https://chrispenner.ca/">Chris Penner’s</a>
talk on
<a href="https://www.youtube.com/watch?v=xZmPuz9m2t0">deconstructing lambdas</a>
unlocked Conal’s paper for me.
In today’s post,
I’m making sure I understand the basics by implementing the
<a href="https://en.wikipedia.org/wiki/Ordinary_least_squares">ordinary least squares estimator</a>
using categories.</p>
<p>The key idea of “Compiling to Categories” is right there in the first sentence:</p>
<blockquote>
<p>As discovered by <a href="https://en.wikipedia.org/wiki/Joachim_Lambek">Joachim Lambek</a>,
the models of the simply typed λ-calculus (STLC)
are exactly the cartesian closed categories (CCC).</p>
</blockquote>
<p>In other words, programming in a cartesian closed category <em>is</em>
programming in a simply typed λ-calculus.
Or more specifically,
the STLC/CCC relationship means
one can program using categories and compile to any language
that supports a STLC.
If you’re not familiar with either the λ-calculus or category theory, that’s fine.
My goal here is not to go in depth into the concepts,
instead I hope my example is a teaser for statisticians
to engage with category theory.</p>
<p>For this post I’m going write a single program for the following,
a formula statisticians will be familiar with:</p>
<p><span class="math inline">\(\hat{\beta} = (X^{\intercal}X)^{-1}X^{\intercal}Y.\)</span></p>
<p>Then I will compile this program into multiple target languages, namely
<a href="https://www.haskell.org/">Haskell</a>
and
<a href="https://www.r-project.org/">R</a>.</p>
<div id="whats-a-category" class="section level2">
<h2>What’s a Category?</h2>
</div>
<div id="compilation-of-categories" class="section level2">
<h2>Compilation of Categories</h2>
</div>
<div id="try-it-out" class="section level2">
<h2>Try it out</h2>
</div>
<div id="notes" class="section level2">
<h2>Notes</h2>
<ul>
<li>In principle, I could have started with the least squares objective function
and <a href="http://conal.net/papers/essence-of-ad/">automatically derive the solution</a>
using category theory.</li>
</ul>
</div>
